Функция ПолучитьЗаписиТаблицы(Соединение, ИмяТаблицы, МассивИменПолей)

	ТЗ_Запроса = Новый ("ТаблицаЗначений");
	
	RecordSet = Новый COMОбъект("ADODB.Recordset");

	//ТекстЗапроса = "SELECT " + ИмяТаблицы + "." + МассивИменПолей[0] + " FROM " + ИмяТаблицы;
	ТекстЗапроса = "SELECT *" + " FROM " + ИмяТаблицы;

	RecordSet.ActiveConnection = Соединение;
	RecordSet.Open(ТекстЗапроса);
	
	// Проверка на пустой результат 
	Если RecordSet.EOF() Тогда
		// и убрать за собой в памяти 
		RecordSet = Неопределено;
		Command = Неопределено;
		Возврат ТЗ_Запроса;
	КонецЕсли;

	Для НомерКолонки = 0 По RecordSet.Fields.Count-1 Цикл
		СтрЗагл = СтрЗаменить(RecordSet.Fields.Item(НомерКолонки).Name,"-","_");
		Пока Не ТЗ_Запроса.Колонки.Найти(СтрЗагл) = Неопределено Цикл
			СтрЗагл = СтрЗагл + "_";
		КонецЦикла;
		ТЗ_Запроса.Колонки.Добавить(СтрЗагл,,RecordSet.Fields.Item(НомерКолонки).Name, 15);
	КонецЦикла;
	
	// Перебор данных 
	RecordSet.MoveFirst();                 
	Пока RecordSet.EOF() = 0 Цикл
		СтрокаТаблицыЗначений = ТЗ_Запроса.Добавить();
		Для НомерКолонки = 0 По RecordSet.Fields.Count-1 Цикл
			СтрокаТаблицыЗначений[НомерКолонки] = RecordSet.Fields(RecordSet.Fields.Item(НомерКолонки).Name).Value;
			Если ТипЗНЧ(СтрокаТаблицыЗначений[НомерКолонки]) = Тип("Число") Тогда
				СтрокаТаблицыЗначений[НомерКолонки] = СтрЗаменить(Формат(СтрокаТаблицыЗначений[НомерКолонки], "ЧРГ = '+'"),"+","");
			КонецЕсли;                
		КонецЦикла;
		RecordSet.MoveNext();  
	КонецЦикла;
	
	RecordSet.Close(); 
    RecordSet = Неопределено;
	
	Возврат ТЗ_Запроса;

КонецФункции // ПолучитьЗаписиТаблицы()
